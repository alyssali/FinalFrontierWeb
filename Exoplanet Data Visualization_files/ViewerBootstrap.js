(function(){
/*! BEGIN MscorlibSlim */
var global=window;(function(global){"use strict";var ss={};ss.initAssembly=function(obj,name,res){};ss.isNullOrUndefined=function ss$isNullOrUndefined(o){return(o===null)||(o===undefined)};ss.isValue=function ss$isValue(o){return(o!==null)&&(o!==undefined)};ss.referenceEquals=function ss$referenceEquals(a,b){return ss.isValue(a)?a===b:!ss.isValue(b)};ss.mkdict=function ss$mkdict(){var a=(arguments.length!=1?arguments:arguments[0]);var r={};for(var i=0;i<a.length;i+=2){r[a[i]]=a[i+1]}return r};ss.clone=function ss$clone(t,o){return o?t.$clone(o):o};ss.coalesce=function ss$coalesce(a,b){return ss.isValue(a)?a:b};ss.isDate=function ss$isDate(obj){return Object.prototype.toString.call(obj)==='[object Date]'};ss.isArray=function ss$isArray(obj){return Object.prototype.toString.call(obj)==='[object Array]'};ss.equals=function ss$equals(a,b){if(!ss.isValue(a))throw new ss_NullReferenceException('Object is null');else if(a!==ss&&typeof(a.equals)==='function')return a.equals(b);if(ss.isDate(a)&&ss.isDate(b))return a.valueOf()===b.valueOf();else if(typeof(a)==='function'&&typeof(b)==='function')return ss.delegateEquals(a,b);else if(ss.isNullOrUndefined(a)&&ss.isNullOrUndefined(b))return true;else return a===b};ss.staticEquals=function ss$staticEquals(a,b){if(!ss.isValue(a))return!ss.isValue(b);else return ss.isValue(b)?ss.equals(a,b):false};ss.shallowCopy=function ss$shallowCopy(source,target){var keys=Object.keys(source);for(var i=0,l=keys.length;i<l;i++){var k=keys[i];target[k]=source[k]}};ss.clearKeys=function ss$clearKeys(d){for(var n in d){if(d.hasOwnProperty(n))delete d[n]}};ss.keyExists=function ss$keyExists(d,key){return d[key]!==undefined};if(!Object.keys){Object.keys=(function(){var hasOwnProperty=Object.prototype.hasOwnProperty,hasDontEnumBug=!({toString:null}).propertyIsEnumerable('toString'),dontEnums=['toString','toLocaleString','valueOf','hasOwnProperty','isPrototypeOf','propertyIsEnumerable','constructor'],dontEnumsLength=dontEnums.length;return function(obj){if(typeof obj!=='object'&&(typeof obj!=='function'||obj===null)){throw new TypeError('Object.keys called on non-object')}var result=[],prop,i;for(prop in obj){if(hasOwnProperty.call(obj,prop)){result.push(prop)}}if(hasDontEnumBug){for(i=0;i<dontEnumsLength;i++){if(hasOwnProperty.call(obj,dontEnums[i])){result.push(dontEnums[i])}}}return result}}())}ss.getKeyCount=function ss$getKeyCount(d){return Object.keys(d).length};ss.setMetadata=function ss$_setMetadata(type,metadata){};ss.initClass=function ss$initClass(ctor,asm,members,baseType,interfaces){if(baseType&&baseType!==Object){var f=function(){};f.prototype=baseType.prototype;ctor.prototype=new f;ctor.prototype.constructor=ctor}ss.shallowCopy(members,ctor.prototype)};ss.initEnum=function ss$initEnum(ctor,asm,members,namedValues){ss.shallowCopy(members,ctor.prototype);ctor.getDefaultValue=ctor.createInstance=function(){return namedValues?null:0};ctor.isInstanceOfType=function(instance){return typeof(instance)==(namedValues?'string':'number')}};ss.getBaseType=function ss$getBaseType(type){throw new Error("Not implemented yet")};ss.isInstanceOfType=function ss$isInstanceOfType(instance,type){if(ss.isNullOrUndefined(instance))return false;if(typeof(type.isInstanceOfType)==='function')return type.isInstanceOfType(instance);return ss.isAssignableFrom(type,ss.getInstanceType(instance))};ss.isAssignableFrom=function ss$isAssignableFrom(target,type){return target===type||(typeof(target.isAssignableFrom)==='function'&&target.isAssignableFrom(type))||type.prototype instanceof target};ss.safeCast=function ss$safeCast(instance,type){if(type===true)return instance;else if(type===false)return null;else return ss.isInstanceOfType(instance,type)?instance:null};ss.cast=function ss$cast(instance,type){if(instance===null||typeof(instance)==='undefined')return instance;else if(type===true||(type!==false&&ss.isInstanceOfType(instance,type)))return instance;throw new ss_InvalidCastException('Cannot cast object to requested type')};ss.getInstanceType=function ss$getInstanceType(instance){if(!ss.isValue(instance))throw new ss_NullReferenceException('Cannot get type of null');try{return instance.constructor}catch(ex){return Object}};ss.getDefaultValue=function ss$getDefaultValue(type){if(typeof(type.getDefaultValue)==='function')return type.getDefaultValue();else if(type===Boolean)return false;else if(type===Date)return new Date(0);else if(type===Number)return 0;return null};var ss_IFormattable=null;var ss_IComparable=null;var ss_IEquatable=null;ss.isNullOrEmptyString=function ss$isNullOrEmptyString(s){return!s||!s.length};if(!String.prototype.trim){String.prototype.trim=function String$trim(){return ss.trimStartString(ss.trimEndString(this))}}ss.trimEndString=function ss$trimEndString(s,chars){return s.replace(chars?new RegExp('['+String.fromCharCode.apply(null,chars)+']+$'):/\s*$/,'')};ss.trimStartString=function ss$trimStartString(s,chars){return s.replace(chars?new RegExp('^['+String.fromCharCode.apply(null,chars)+']+'):/^\s*/,'')};ss.trimString=function ss$trimString(s,chars){return ss.trimStartString(ss.trimEndString(s,chars),chars)};ss.arrayClone=function ss$arrayClone(arr){if(arr.length===1){return[arr[0]]}else{return Array.apply(null,arr)}};ss._delegateContains=function ss$_delegateContains(targets,object,method){for(var i=0;i<targets.length;i+=2){if(targets[i]===object&&targets[i+1]===method){return true}}return false};ss._mkdel=function ss$_mkdel(targets){var delegate=function(){if(targets.length==2){return targets[1].apply(targets[0],arguments)}else{var clone=ss.arrayClone(targets);for(var i=0;i<clone.length;i+=2){if(ss._delegateContains(targets,clone[i],clone[i+1])){clone[i+1].apply(clone[i],arguments)}}return null}};delegate._targets=targets;return delegate};ss.mkdel=function ss$mkdel(object,method){if(!object){return method}return ss._mkdel([object,method])};ss.delegateCombine=function ss$delegateCombine(delegate1,delegate2){if(!delegate1){if(!delegate2._targets){return ss.mkdel(null,delegate2)}return delegate2}if(!delegate2){if(!delegate1._targets){return ss.mkdel(null,delegate1)}return delegate1}var targets1=delegate1._targets?delegate1._targets:[null,delegate1];var targets2=delegate2._targets?delegate2._targets:[null,delegate2];return ss._mkdel(targets1.concat(targets2))};ss.delegateRemove=function ss$delegateRemove(delegate1,delegate2){if(!delegate1||(delegate1===delegate2)){return null}if(!delegate2){return delegate1}var targets=delegate1._targets;var object=null;var method;if(delegate2._targets){object=delegate2._targets[0];method=delegate2._targets[1]}else{method=delegate2}for(var i=0;i<targets.length;i+=2){if((targets[i]===object)&&(targets[i+1]===method)){if(targets.length==2){return null}var t=ss.arrayClone(targets);t.splice(i,2);return ss._mkdel(t)}}return delegate1};ss.delegateEquals=function ss$delegateEquals(a,b){if(a===b)return true;if(!a._targets&&!b._targets)return false;var ta=a._targets||[null,a],tb=b._targets||[null,b];if(ta.length!=tb.length)return false;for(var i=0;i<ta.length;i++){if(ta[i]!==tb[i])return false}return true};var ss_Enum=function Enum$(){};ss.Enum=ss_Enum;ss.initClass(ss_Enum,ss,{});ss_Enum.getValues=function Enum$getValues(enumType){var parts=[];var values=enumType.prototype;for(var i in values){if(values.hasOwnProperty(i))parts.push(values[i])}return parts};var ss_IEnumerator=null;var ss_IEnumerable=null;ss.getEnumerator=function ss$getEnumerator(obj){return obj.getEnumerator?obj.getEnumerator():new ss_ArrayEnumerator(obj)};ss.unbox=function ss$unbox(instance){if(!ss.isValue(instance))throw new ss_InvalidOperationException('Nullable object must have a value.');return instance};var ss_Nullable$1=function Nullable$1$(T){};ss.Nullable$1=ss_Nullable$1;ss_Nullable$1.eq=function Nullable$eq(a,b){return!ss.isValue(a)?!ss.isValue(b):(a===b)};ss_Nullable$1.ne=function Nullable$eq(a,b){return!ss.isValue(a)?ss.isValue(b):(a!==b)};ss_Nullable$1.le=function Nullable$le(a,b){return ss.isValue(a)&&ss.isValue(b)&&a<=b};ss_Nullable$1.ge=function Nullable$ge(a,b){return ss.isValue(a)&&ss.isValue(b)&&a>=b};ss_Nullable$1.lt=function Nullable$lt(a,b){return ss.isValue(a)&&ss.isValue(b)&&a<b};ss_Nullable$1.gt=function Nullable$gt(a,b){return ss.isValue(a)&&ss.isValue(b)&&a>b};ss_Nullable$1.sub=function Nullable$sub(a,b){return ss.isValue(a)&&ss.isValue(b)?a-b:null};ss_Nullable$1.add=function Nullable$add(a,b){return ss.isValue(a)&&ss.isValue(b)?a+b:null};ss_Nullable$1.mod=function Nullable$mod(a,b){return ss.isValue(a)&&ss.isValue(b)?a%b:null};ss_Nullable$1.div=function Nullable$divf(a,b){return ss.isValue(a)&&ss.isValue(b)?a/b:null};ss_Nullable$1.mul=function Nullable$mul(a,b){return ss.isValue(a)&&ss.isValue(b)?a*b:null};ss_Nullable$1.band=function Nullable$band(a,b){return ss.isValue(a)&&ss.isValue(b)?a&b:null};ss_Nullable$1.bor=function Nullable$bor(a,b){return ss.isValue(a)&&ss.isValue(b)?a|b:null};ss_Nullable$1.xor=function Nullable$xor(a,b){return ss.isValue(a)&&ss.isValue(b)?a^b:null};ss_Nullable$1.shl=function Nullable$shl(a,b){return ss.isValue(a)&&ss.isValue(b)?a<<b:null};ss_Nullable$1.srs=function Nullable$srs(a,b){return ss.isValue(a)&&ss.isValue(b)?a>>b:null};ss_Nullable$1.sru=function Nullable$sru(a,b){return ss.isValue(a)&&ss.isValue(b)?a>>>b:null};ss_Nullable$1.and=function Nullable$and(a,b){if(a===true&&b===true)return true;else if(a===false||b===false)return false;else return null};ss_Nullable$1.or=function Nullable$or(a,b){if(a===true||b===true)return true;else if(a===false&&b===false)return false;else return null};ss_Nullable$1.not=function Nullable$not(a){return ss.isValue(a)?!a:null};ss_Nullable$1.neg=function Nullable$neg(a){return ss.isValue(a)?-a:null};ss_Nullable$1.pos=function Nullable$pos(a){return ss.isValue(a)?+a:null};ss_Nullable$1.cpl=function Nullable$cpl(a){return ss.isValue(a)?~a:null};ss_Nullable$1.lift=function Nullable$lift(){for(var i=0;i<arguments.length;i++){if(!ss.isValue(arguments[i]))return null}return arguments[0].apply(null,Array.prototype.slice.call(arguments,1))};var ss_Int32=function Int32$(){};ss.Int32=ss_Int32;ss.initClass(ss_Int32,ss,{},Object,[ss_IEquatable,ss_IComparable,ss_IFormattable]);ss_Int32.getDefaultValue=ss_Int32.createInstance=function Int32$getDefaultValue(){return 0};ss_Int32.div=function Int32$div(a,b){if(!ss.isValue(a)||!ss.isValue(b))return null;if(b===0)throw new ss_DivideByZeroException;return ss_Int32.trunc(a/b)};ss_Int32.trunc=function Int32$trunc(n){return ss.isValue(n)?(n>0?Math.floor(n):Math.ceil(n)):null};var ss_JsDate=function JsDate$(){};ss_JsDate.__typeName='ss.JsDate';ss.JsDate=ss_JsDate;ss.initClass(ss_JsDate,ss,{},Object,[ss_IEquatable,ss_IComparable]);ss_JsDate.createInstance=function JsDate$createInstance(){return new Date};ss_JsDate.isInstanceOfType=function JsDate$isInstanceOfType(instance){return instance instanceof Date};var ss_ArrayEnumerator=function ArrayEnumerator$(array){this._array=array;this._index=-1};ss.ArrayEnumerator=ss_ArrayEnumerator;ss.initClass(ss_ArrayEnumerator,ss,{moveNext:function ArrayEnumerator$moveNext(){this._index++;return(this._index<this._array.length)},reset:function ArrayEnumerator$reset(){this._index=-1},current:function ArrayEnumerator$current(){if(this._index<0||this._index>=this._array.length)throw'Invalid operation';return this._array[this._index]},dispose:function ArrayEnumerator$dispose(){}},null,[ss_IEnumerator,ss_IDisposable]);var ss_ObjectEnumerator=function ObjectEnumerator$(o){this._keys=Object.keys(o);this._index=-1;this._object=o};ss.ObjectEnumerator=ss_ObjectEnumerator;ss.initClass(ss_ObjectEnumerator,ss,{moveNext:function ObjectEnumerator$moveNext(){this._index++;return(this._index<this._keys.length)},reset:function ObjectEnumerator$reset(){this._index=-1},current:function ObjectEnumerator$current(){if(this._index<0||this._index>=this._keys.length)throw new ss_InvalidOperationException('Invalid operation');var k=this._keys[this._index];return{key:k,value:this._object[k]}},dispose:function ObjectEnumerator$dispose(){}},null,[ss_IEnumerator,ss_IDisposable]);var ss_IDisposable=null;var ss_StringBuilder=function StringBuilder$(s){this._parts=(ss.isValue(s)&&s!='')?[s]:[];this.length=ss.isValue(s)?s.length:0};ss.StringBuilder=ss_StringBuilder;ss.initClass(ss_StringBuilder,ss,{append:function StringBuilder$append(o){if(ss.isValue(o)){var s=o.toString();this._parts.push(s);this.length+=s.length}return this},appendChar:function StringBuilder$appendChar(c){return this.append(String.fromCharCode(c))},appendLine:function StringBuilder$appendLine(s){this.append(s);this.append('\r\n');return this},appendLineChar:function StringBuilder$appendLineChar(c){return this.appendLine(String.fromCharCode(c))},clear:function StringBuilder$clear(){this._parts=[];this.length=0},toString:function StringBuilder$toString(){return this._parts.join('')}});var ss_Exception=function Exception$(message,innerException){this._message=message||'An error occurred.';this._innerException=innerException||null;this._error=new Error};ss.Exception=ss_Exception;ss.initClass(ss_Exception,ss,{get_message:function Exception$get_message(){return this._message},get_innerException:function Exception$get_innerException(){return this._innerException},get_stack:function Exception$get_stack(){return this._error.stack},toString:function Exception$toString(){var message=this._message;var exception=this;if(ss.isNullOrEmptyString(message)){if(ss.isValue(ss.getInstanceType(exception))&&ss.isValue(ss.getTypeFullName(ss.getInstanceType(exception)))){message=ss.getTypeFullName(ss.getInstanceType(exception))}else{message='[object Exception]'}}return message}});ss_Exception.wrap=function Exception$wrap(o){if(ss.isInstanceOfType(o,ss_Exception)){return o}else if(o instanceof TypeError){return new ss_NullReferenceException(o.message,new ss_JsErrorException(o))}else if(o instanceof RangeError){return new ss_ArgumentOutOfRangeException(null,o.message,new ss_JsErrorException(o))}else if(o instanceof Error){return new ss_JsErrorException(o)}else{return new ss_Exception(o.toString())}};var ss_NotImplementedException=function NotImplementedException$(message,innerException){ss_Exception.call(this,message||'The method or operation is not implemented.',innerException)};ss_NotImplementedException.__typeName='ss.NotImplementedException';ss.NotImplementedException=ss_NotImplementedException;ss.initClass(ss_NotImplementedException,ss,{},ss_Exception);var ss_NotSupportedException=function NotSupportedException$(message,innerException){ss_Exception.call(this,message||'Specified method is not supported.',innerException)};ss_NotSupportedException.__typeName='ss.NotSupportedException';ss.NotSupportedException=ss_NotSupportedException;ss.initClass(ss_NotSupportedException,ss,{},ss_Exception);var ss_AggregateException=function AggregateException$(message,innerExceptions){this.innerExceptions=ss.isValue(innerExceptions)?ss.arrayFromEnumerable(innerExceptions):[];ss_Exception.call(this,message||'One or more errors occurred.',this.innerExceptions.length?this.innerExceptions[0]:null)};ss_AggregateException.__typeName='ss.AggregateException';ss.AggregateException=ss_AggregateException;ss.initClass(ss_AggregateException,ss,{flatten:function AggregateException$flatten(){var inner=[];for(var i=0;i<this.innerExceptions.length;i++){var e=this.innerExceptions[i];if(ss.isInstanceOfType(e,ss_AggregateException)){inner.push.apply(inner,e.flatten().innerExceptions)}else{inner.push(e)}}return new ss_AggregateException(this._message,inner)}},ss_Exception);var ss_PromiseException=function PromiseException(args,message,innerException){ss_Exception.call(this,message||(args.length&&args[0]?args[0].toString():'An error occurred'),innerException);this.arguments=ss.arrayClone(args)};ss_PromiseException.__typeName='ss.PromiseException';ss.PromiseException=ss_PromiseException;ss.initClass(ss_PromiseException,ss,{get_arguments:function PromiseException$get_arguments(){return this._arguments}},ss_Exception);var ss_JsErrorException=function JsErrorException$(error,message,innerException){ss_Exception.call(this,message||error.message,innerException);this.error=error};ss_JsErrorException.__typeName='ss.JsErrorException';ss.JsErrorException=ss_JsErrorException;ss.initClass(ss_JsErrorException,ss,{get_stack:function Exception$get_stack(){return this.error.stack}},ss_Exception);var ss_ArgumentException=function ArgumentException$(message,paramName,innerException){ss_Exception.call(this,message||'Value does not fall within the expected range.',innerException);this.paramName=paramName||null};ss_ArgumentException.__typeName='ss.ArgumentException';ss.ArgumentException=ss_ArgumentException;ss.initClass(ss_ArgumentException,ss,{},ss_Exception);var ss_ArgumentNullException=function ArgumentNullException$(paramName,message,innerException){if(!message){message='Value cannot be null.';if(paramName)message+='\nParameter name: '+paramName}ss_ArgumentException.call(this,message,paramName,innerException)};ss_ArgumentNullException.__typeName='ss.ArgumentNullException';ss.ArgumentNullException=ss_ArgumentNullException;ss.initClass(ss_ArgumentNullException,ss,{},ss_ArgumentException);var ss_ArgumentOutOfRangeException=function ArgumentOutOfRangeException$(paramName,message,innerException,actualValue){if(!message){message='Value is out of range.';if(paramName)message+='\nParameter name: '+paramName}ss_ArgumentException.call(this,message,paramName,innerException);this.actualValue=actualValue||null};ss_ArgumentOutOfRangeException.__typeName='ss.ArgumentOutOfRangeException';ss.ArgumentOutOfRangeException=ss_ArgumentOutOfRangeException;ss.initClass(ss_ArgumentOutOfRangeException,ss,{},ss_ArgumentException);var ss_FormatException=function FormatException$(message,innerException){ss_Exception.call(this,message||'Invalid format.',innerException)};ss_FormatException.__typeName='ss.FormatException';ss.FormatException=ss_FormatException;ss.initClass(ss_FormatException,ss,{},ss_Exception);var ss_DivideByZeroException=function DivideByZeroException$(message,innerException){ss_Exception.call(this,message||'Division by 0.',innerException)};ss_DivideByZeroException.__typeName='ss.DivideByZeroException';ss.DivideByZeroException=ss_DivideByZeroException;ss.initClass(ss_DivideByZeroException,ss,{},ss_Exception);var ss_InvalidCastException=function InvalidCastException$(message,innerException){ss_Exception.call(this,message||'The cast is not valid.',innerException)};ss_InvalidCastException.__typeName='ss.InvalidCastException';ss.InvalidCastException=ss_InvalidCastException;ss.initClass(ss_InvalidCastException,ss,{},ss_Exception);var ss_InvalidOperationException=function InvalidOperationException$(message,innerException){ss_Exception.call(this,message||'Operation is not valid due to the current state of the object.',innerException)};ss_InvalidOperationException.__typeName='ss.InvalidOperationException';ss.InvalidOperationException=ss_InvalidOperationException;ss.initClass(ss_InvalidOperationException,ss,{},ss_Exception);var ss_NullReferenceException=function NullReferenceException$(message,innerException){ss_Exception.call(this,message||'Object is null.',innerException)};ss_NullReferenceException.__typeName='ss.NullReferenceException';ss.NullReferenceException=ss_NullReferenceException;ss.initClass(ss_NullReferenceException,ss,{},ss_Exception);var ss_KeyNotFoundException=function KeyNotFoundException$(message,innerException){ss_Exception.call(this,message||'Key not found.',innerException)};ss_KeyNotFoundException.__typeName='ss.KeyNotFoundException';ss.KeyNotFoundException=ss_KeyNotFoundException;ss.initClass(ss_KeyNotFoundException,ss,{},ss_Exception);var ss_AmbiguousMatchException=function AmbiguousMatchException$(message,innerException){ss_Exception.call(this,message||'Ambiguous match.',innerException)};ss_AmbiguousMatchException.__typeName='ss.AmbiguousMatchException';ss.AmbiguousMatchException=ss_AmbiguousMatchException;ss.initClass(ss_AmbiguousMatchException,ss,{},ss_Exception);if(typeof(global.HTMLElement)==='undefined'){global.HTMLElement=Element}if(typeof(global.MessageEvent)==='undefined'){global.MessageEvent=Event}Date.now=Date.now||function(){return+new Date};global.ss=ss})(global);
/*! BEGIN Bootstrap */
(function(){'dont use strict';var a={};global.tab=global.tab||{};global.tabBootstrap=global.tabBootstrap||{};ss.initAssembly(a,'ViewerBootstrap');var b=function(e,x,C,D){this.$1$1=null;this.$1$2=null;this.$1$3=null;this.$1$4=null;this.set_name(e);this.set_commandId(x);this.set_hostId(C);this.set_parameters(D)};b.__typeName='tab._ApiCommand';b.generateNextCommandId=function(){var e='cmd'+b.$0;b.$0++;return e};b.parse=function(e){var x;var C=e.indexOf(String.fromCharCode(44));if(C<0){x=e;return new b(x,null,null,null)}x=e.substr(0,C);var D;var E=e.substr(C+1);C=E.indexOf(String.fromCharCode(44));if(C<0){D=E;return new b(x,D,null,null)}D=E.substr(0,C);var F;var G=E.substr(C+1);C=G.indexOf(String.fromCharCode(44));if(C<0){F=G;return new b(x,D,F,null)}F=G.substr(0,C);var H=G.substr(C+1);return new b(x,D,F,H)};global.tab._ApiCommand=b;var c=function(e,x,C){this.$1=null;this.$2=null;this.$0=null;this.$1=e;this.$2=x;this.$0=C};c.__typeName='tab._ApiServerNotification';c.deserialize=function(e){var x=JSON.parse(e);var C=x['api.workbookName'];var D=x['api.worksheetName'];var E=x['api.commandData'];return new c(C,D,E)};global.tab._ApiServerNotification=c;var d=function(e){this.$1=null;this.$0=null;var x=JSON.parse(e);this.$1=x['api.commandResult'];this.$0=x['api.commandData']};d.__typeName='tab._ApiServerResultParser';global.tab._ApiServerResultParser=d;var f=function(e,x){this.$0=null;this.$1$1=null;this.set_name(e);this.$0=x};f.__typeName='tab.NonApiCommand';f.parse=function(e){var x=e.split(String.fromCharCode(44));var C=x[0];var D=x.slice(1);return new f(C,D)};global.tab.NonApiCommand=f;var g=function(){};g.__typeName='tabBootstrap.$0';g.$4=function(e){var x=g.$2(e);y.mark(x);return x};g.$5=function(){y.mark('AppStartEpochMarker')};g.$3=function(e,x){var C=g.$1(e);var D=x;if(ss.isNullOrUndefined(D)){D=g.$2(e)}x=D;y.mark(C);y.measure('✚ '+e,x,C)};g.$0=function(e,x){e=t.getFriendlyEventDescription(e);if(ss.isValue(x)){e+=' '+x}return e};g.$2=function(e){return'__start__'+e};g.$1=function(e){return'__end__'+e};var h=function(e,x,C){this.$6=null;s.call(this,t.$3().$0(),e,x);x=g.$0(x,C);this.open=true;this.$6=x+'#'+h.$0++;g.$4(this.$6)};h.__typeName='tabBootstrap.$1';var i=function(){s.$ctor1.call(this,-1,0,'',null);this.open=false;this.start=0;this.end=0};i.__typeName='tabBootstrap.$2';i.$0=function(){if(ss.isNullOrUndefined(i.$1)){i.$1=new i}return i.$1};var j=function(){};j.__typeName='tabBootstrap.$3';j.$0=function(){var e={parseOnLoad:true,usePlainJson:true,noFirebugLite:true,useXDomain:tsConfig.xdomain_active,locale:'en-us'};if(tsConfig.xdomain_active){var x={tableau:tsConfig.external_static_asset_prefix+'/javascripts/built-dojo/tableau'};e.modulePaths=x;e.baseUrl=tsConfig.external_static_asset_prefix+'/javascripts/built-dojo/dojo/';e.dojoBlankHtmlUrl=tsConfig.local_static_asset_prefix+'/javascripts/blank.html'}if(tsConfig.debugMode){try{var C=new RegExp('[?&][:]?debug=');if(window.location.search.search(C)!==-1){e.isDebug=true;e.debugAtAllCosts=true}}catch(D){}}window.self['djConfig']=e};var k=function(){};k.__typeName='tabBootstrap.$4';k.$1=function(e){var x=document.getElementById(e);if(ss.isValue(x)){x.style.display='none'}};k.$2=function(){var e=document.getElementById('tsConfigContainer');var x=JSON.parse(e.value);window.self['tsConfig']=x};k.$0=function(e){var x=document.getElementById('tabBootErr');var C=x.childNodes[1].lastChild;C.textContent+='\n'+e;x.style.display='block';k.$1('loadingGlassPane');k.$1('loadingSpinner');try{window.parent.postMessage('tableau.completed','*')}catch(D){}return false};var l=function(){};l.__typeName='tabBootstrap.$5';var m=function(){};m.__typeName='tabBootstrap.ApiCommandResponder';m.$0=function(e,x,C){var D={};D['api.workbookName']=e;D['api.worksheetName']=x;D['api.commandData']=C;return JSON.stringify(D)};global.tabBootstrap.ApiCommandResponder=m;var n=function(){m.call(this)};n.__typeName='tabBootstrap.ApiCrossDomainResponder';global.tabBootstrap.ApiCrossDomainResponder=n;var o=function(e){this.$2$1=null;m.call(this);this.set_responseAction(e)};o.__typeName='tabBootstrap.ApiNativeHostResponder';global.tabBootstrap.ApiNativeHostResponder=o;var p=function(){};p.__typeName='tabBootstrap.BaseUrlFormatter';p.formatBaseUrl=function(){return window.location.protocol+'//'+window.location.host};p.formatUrlRoot=function(e,x){var C=e;if(ss.isValue(x)){C+=x}else if(ss.isValue(tsConfig.vizql_root)){C+=tsConfig.vizql_root}else{var D=window.location.pathname;D=D.replace(new RegExp('\\/[^\\/]*$'),'');C+=D}return C};p.formatSessionMethod=function(e,x,C){return C+'/'+e+'/sessions/'+x};p.formatBootstrapSessionMethod=function(e,x,C){return p.formatSessionMethod(e,x,p.formatUrlRoot(p.formatBaseUrl(),C))};global.tabBootstrap.BaseUrlFormatter=p;var q=function(){};q.__typeName='tabBootstrap.EmbedMode';global.tabBootstrap.EmbedMode=q;var r=function(){};r.__typeName='tabBootstrap.Metric';r.isEqual=function(e,x){return e.w===x.w&&e.h===x.h};r.isInstanceOfType=function(){return true};global.tabBootstrap.Metric=r;var s=function(e,x,C){this.$3=0;this.$4=0;this.$1=null;this.$2=null;this.start=0;this.end=0;this.open=false;this.$5=null;this.$3=e;this.$4=x;this.$1=C;this.start=t.getTiming();this.open=true};s.__typeName='tabBootstrap.MetricsContext';s.$ctor1=function(e,x,C,D){s.call(this,e,x,C);this.$2=D;if(t.$7){this.$5=new h(x,C,D)}};global.tabBootstrap.MetricsContext=s;var t=function(){this.$8=0;this.$3=[];this.$4=[];this.$5=[];this.$9='';this.$b='';this.$a='';this.$6='';this.$7=0;if(ss.isValue(tsConfig.metricsFilter)&&tsConfig.metricsFilter!==''){var e=0;var x=tsConfig.metricsFilter.split(String.fromCharCode(124));for(var C=0;C<x.length;C++){var D=x[C];var E=((typeof(D['trim'])==='function')?D.trim():D);E=E.toLowerCase();if(ss.keyExists(t.$8,E)){e|=t.$8[E]}}this.$7=e}};t.__typeName='tabBootstrap.MetricsController';t.$3=function(){if(ss.isNullOrUndefined(t.$9)){t.$9=new t}return t.$9};t.createContext=function(e,x,C){if(ss.isNullOrUndefined(x)){x=32}var D=x===0||(x&t.$3().$7)!==x;var E;if(D){if(t.$7){E=new h(x,e,C)}else{E=i.$0()}}else{E=new s.$ctor1(t.$3().$0(),x,e,C);t.$3().$3.push(E)}return E};t.logMetricsEvent=function(e,x){var C={t:t.getTiming(),d:e};if(x===2){C.e=C.t-t.$4}t.logEventInternalUse(new u('gen',x,C))};t.logEventInternalUse=function(e){if(t.$7&&e.eventType!=='init'){t.$6.logEvent(e)}if(e.metricSuite===0||(e.metricSuite&t.$3().$7)!==e.metricSuite){return}if(t.$3().$5.length>0){t.$2(e)}else{t.$3().$4.push(e)}};t.$2=function(e){e.parameters.sid=t.$3().$6;var x=t.$3().$5;for(var C=0;C<x.length;C++){var D=x[C];D.logEvent(e)}};t.setEventLoggers=function(e){t.$3().$5=e;if(ss.isValue(e)&&t.$9.$4.length>0){for(var x=0;x<t.$9.$4.length;x++){var C=t.$9.$4[x];t.$2(C)}t.$9.$4=[]}};t.initSessionInfo=function(){var e=t.$3();var x=(ss.isNullOrEmptyString(tsConfig.current_sheet_name)?tsConfig.sheetId:tsConfig.current_sheet_name);if(ss.referenceEquals(e.$9,tsConfig.sessionid)&&ss.referenceEquals(e.$b,tsConfig.workbookName)&&ss.referenceEquals(e.$a,x)){return}e.$9=tsConfig.sessionid;e.$b=tsConfig.workbookName;e.$a=x;var C=new Date;e.$6=C.getTime().toString(36);e.$6=e.$6.substr(e.$6.length-6);if(e.$9.length>=5){e.$6=e.$6+e.$9.substr(1,1);e.$6=e.$6+e.$9.substr(4,1)}e.$2()};t.getFriendlyEventDescription=function(e){return ss.coalesce(t.$5[e],e)};t.$1=function(e){var x=e.$3;var C=-1;for(var D=t.$3().$3.length-1;D>=0;D--){if(t.$9.$3[D].$3===x){C=D;break}}if(C!==-1){var E=t.$9.$3.length-C;for(var F=0;F<E;F++){t.$9.$3.pop()}}t.$9.$1(e)};t.$0=function(e){var x={id:e.$3.toString(),d:e.$1};if(ss.isValue(e.$2)){x.ei=e.$2}return x};global.tabBootstrap.MetricsController=t;var u=function(e,x,C){this.eventType=null;this.metricSuite=0;this.parameters=null;this.eventType=e;this.metricSuite=x;this.parameters=C};u.__typeName='tabBootstrap.MetricsEvent';global.tabBootstrap.MetricsEvent=u;var v=function(){};v.__typeName='tabBootstrap.MetricsSuites';global.tabBootstrap.MetricsSuites=v;var w=function(){this.navType=null;this.navSrc=null;if(z.get_isEmbeddedInsideAnotherPage()){var e=parseInt(z.get_hashNavType());this.navType=this.$0(e)}if(ss.isValue(this.navType)){this.navSrc=z.get_hashNavSrc()}else{this.navSrc=(z.get_isEmbeddedInsideAnotherPage()?'Boot'.toString():'Top'.toString());this.navType=this.$0(z.get_navigationType())}};w.__typeName='tabBootstrap.NavigationInfo';global.tabBootstrap.NavigationInfo=w;var y=function(){};y.__typeName='tabBootstrap.PerformanceReporting';y.mark=function(e){if(y.supportsPerfApi){performance.mark(e)}};y.measure=function(e,x,C){if(y.supportsPerfApi){try{performance.measure(e,x,C)}catch(D){var e=ss.Exception.wrap(D)}}};global.tabBootstrap.PerformanceReporting=y;var z=function(){};z.__typeName='tabBootstrap.Utility';z.$b=function(){try{var e=z.$4();var x=e.orientation;return ss.isValue(x)&&(x===90||x===-90)}catch(C){}return false};z.get_urlLocationSearchParams=function(){return z.$a(z.get_urlLocationSearch().substring(1))};z.get_urlLocationHashData=function(){var e={};var x=z.get_urlLocationHash();if(x.length<2){return{}}x=x.substr(1);var C=x.split('&');for(var D=0;D<C.length;D++){var E=C[D];var F=E.split('=');if(F.length===1){e['cn']=F[0]}else if(F.length===2){var G=decodeURIComponent(F[0]);var H=decodeURIComponent(F[1]);e[G]=H}}return e};z.set_urlLocationHashData=function(e){var x=new ss.StringBuilder;var C=true;var D=function(){x.append((C?'#':'&'));C=false};var E=new ss.ObjectEnumerator(e);try{while(E.moveNext()){var F=E.current();var G=encodeURIComponent(F.key);D();if(G==='cn'){x.append(F.value)}else if(ss.isNullOrUndefined(F.value)){x.append(G)}else{x.append(G).append('=').append(encodeURIComponent(F.value))}}}finally{E.dispose()}if(ss.isValue(x)){var H=z.get_locationWindow();if(z.historyApiSupported()){z.replaceState(H,null,null,x.toString())}else{H.location.hash=x.toString()}}};z.get_urlLocationHash=function(){var e=z.get_locationWindow();return e.location.hash};z.get_urlLocationSearch=function(){var e=z.get_locationWindow();return e.location.search};z.get_embedMode=function(){return z.$c};z.get_isEmbeddedInsideAnotherPage=function(){return z.get_embedMode()==='sameDomainEmbedded'||z.get_embedMode()==='crossDomainEmbedded'};z.get_locationWindow=function(){return window.self};z.$a=function(e){var x={};var C=e.split('&');for(var D=0;D<C.length;D++){var E=C[D];var F=E.split('=');if(F.length===2){var G=decodeURIComponent(F[0]);var H=decodeURIComponent(F[1]);x[G]=H}}return x};z.xhrPostJsonChunked=function(x,C,D,E,F,G){var H=new XMLHttpRequest;H.open('POST',x,G);H.setRequestHeader('Accept','text/javascript');H.setRequestHeader('Content-Type','application/x-www-form-urlencoded');if(!ss.isNullOrUndefined(tsConfig.sheetId)){H.setRequestHeader('X-Tsi-Active-Tab',tsConfig.sheetId)}var I=z.$2(H,F);var J=0;var K=function(){var e='';try{e=H.responseText}catch(X){}var O=e.length;while(J<O){var P=e.substr(J);var Q=new RegExp('^(\\d+);');var R=P.match(Q);if(!ss.isValue(R)){return}var S=R[0].length;var T=parseInt(R[1]);if(S+T>P.length){return}P=P.substr(S,T);var U=null;try{var V='Parse '+((J===0)?'Primary':'Secondary')+' JSON';{var W=t.createContext(V,32,null);try{U=z.$9(P)}finally{if(ss.isValue(W)){W.dispose()}}}}catch(X){I(new ss.Exception('Invalid JSON'))}if(J===0){D(U)}else{E(U)}J+=S+T}};var L=-1;var M=false;var N=window.navigator.userAgent.indexOf('MSIE')>=0&&parseFloat(window.navigator.appVersion.split('MSIE ')[1])<10;H.onreadystatechange=function(){try{if(!N&&H.readyState===3&&H.status===200&&!M){K();if(L===-1){L=window.setInterval(K,10)}M=true;return}if(H.readyState!==4){return}if(L!==-1){window.clearInterval(L);L=-1}if(z.$8(H)){K()}else{I(new ss.Exception('Unable to load '+x+'; status: '+H.status))}}catch(e){var ex=ss.Exception.wrap(e);if(typeof(ss.getType('ss'))==='undefined'){H.abort()}else{throw ex}}};try{H.send(C)}catch(O){var e=ss.Exception.wrap(O);I(e)}};z.xhrGetXmlSynchronous=function(x,C){var D=new XMLHttpRequest;D.open('GET',x,false);D.setRequestHeader('Accept','text/xml');try{D.send()}catch(E){var e=ss.Exception.wrap(E);z.$7(D,C,e);return null}return D.responseText};z.xhrPostJson=function(C,D,E,F,G){var H=new XMLHttpRequest;H.open('POST',C,G);H.setRequestHeader('Accept','text/javascript');H.setRequestHeader('Content-Type','application/x-www-form-urlencoded');if(ss.isValue(tsConfig.sheetId)){H.setRequestHeader('X-Tsi-Active-Tab',tsConfig.sheetId)}var I=z.$2(H,F);H.onreadystatechange=function(){if(H.readyState!==4){return}if(z.$8(H)){try{var e=z.$9(H.responseText);E(e)}catch(J){var x=ss.Exception.wrap(J);I(x)}}else{I(new ss.Exception('Unable to load '+C+'; status: '+H.status))}};try{H.send(D)}catch(J){var e=ss.Exception.wrap(J);I(e)}};z.attachOneTimeMessageHandler=function(e){var x=null;x=function(C){var D=C;if(e(D)){if(ss.isValue(window.self.removeEventListener)){window.removeEventListener('message',x,false)}else{window.self.detachEvent('onmessage',x)}}};if(ss.isValue(window.self.addEventListener)){window.addEventListener('message',x,false)}else{window.self.attachEvent('onmessage',x)}};z.sendCommandWithContext=function(e){var x=false;var C=[];if(tsConfig.loadOrderID>=0){C.push(tsConfig.loadOrderID)}if(!ss.isNullOrEmptyString(tsConfig.apiID)){if(tsConfig.loadOrderID<0){C.push(tsConfig.loadOrderID)}C.push(tsConfig.apiID)}var D=new f(e,C);x=z.doPostMessage(D.serialize());return x};z.doPostMessage=function(e){var x=false;if('postMessage'in window){try{window.parent.postMessage(e,'*');x=true}catch(C){}}return x};z.$0=function(){var e=false;var x=false;try{e=ss.referenceEquals(window.self,window.parent);x=ss.isNullOrUndefined(window.parent.outerWidth)}catch(C){x=true}if(e){return'notEmbedded'}else if(x){return'crossDomainEmbedded'}else{return'sameDomainEmbedded'}};z.$9=function(e){if(ss.isNullOrUndefined(e)||typeof(e)!=='string'){return null}e=e.trim();var x=JSON.parse(e);return x};z.$5=function(){var e=window.document.documentElement;return{w:e.clientWidth,h:e.clientHeight}};z.$6=function(){return{w:window.innerWidth,h:window.innerHeight}};z.$4=function(){var e=window.self;while(ss.isValue(e.parent)&&!ss.referenceEquals(e.parent,e)){e=e.parent}return e};z.$3=function(){var e,x;var C=window.document.documentElement.clientWidth;var D=window.document.documentElement.clientHeight;var E=window.navigator.userAgent.indexOf('Android')!==-1;if(E){if(C===window.screen.height){x=window.screen.width-D;e=C-x;C=D+x;D=e}}else if(z.$b()){if(C===window.screen.width){x=window.screen.height-D;e=C-x;C=D+x;D=e}}else if(C===window.screen.height){x=window.screen.width-D;e=C-x;C=D+x;D=e}return{w:C,h:D}};z.get_hashClientNumber=function(){var e=z.get_urlLocationHashData();return((ss.isValue(e)&&ss.isValue(e['cn']))?e['cn']:'')};z.get_navigationType=function(){return window.performance.navigation.type};z.get_hashNavType=function(){var e=z.get_urlLocationHashData();return((ss.isValue(e)&&ss.isValue(e['navType']))?e['navType']:'')};z.get_hashNavSrc=function(){var e=z.get_urlLocationHashData();return((ss.isValue(e)&&ss.isValue(e['navSrc']))?e['navSrc']:'')};z.addToUrlHash=function(e,x){var C=z.get_urlLocationHashData();C[e]=x;z.set_urlLocationHashData(C)};z.historyApiSupported=function(){return typeof(window.history['pushState'])==='function'&&typeof(window.history['replaceState'])==='function'};z.replaceState=function(e,x,C,D){try{e.history.replaceState(x,C,D)}catch(E){}};z.getValueFromUrlHash=function(e){var x=z.get_urlLocationHashData();return(ss.keyExists(x,e)?x[e]:'')};z.removeEntryFromUrlHash=function(e){var x=z.get_urlLocationHashData();delete x[e];z.set_urlLocationHashData(x)};z.$1=function(){var e=1;if(ss.isValue(tsConfig.highDpi)&&tsConfig.highDpi){if(ss.isValue(tsConfig.pixelRatio)){e=tsConfig.pixelRatio}else{e=ss.coalesce(window.self['devicePixelRatio'],1)}}return e};z.$8=function(e){var x=(ss.isValue(e.status)?e.status:0);if(x>=200&&x<300||x===304||x===1223||x===0&&(window.location.protocol==='file:'||window.location.protocol==='chrome:')){return true}return false};z.$7=function(e,x,C){if(ss.staticEquals(x,null)){return}var D=z.$2(e,x);D(C)};z.$2=function(e,x){return function(C){C.status=e.status;C.responseText=e.responseText;x(C)}};global.tabBootstrap.Utility=z;var A=function(e){this.location=null;this.toolbarDisplayed=false;this.rid=0;this.ts=0;this.isVisibleRectCommunicationEnabled=false;this.apiResponder=null;this.$5=null;this.$8=null;this.$7=null;this.$6=null;this.authoringLeftAreaWidth=0;this.rightAreaDrawerWidth=0;this.clearSessionOnUnload=false;this.initialLayoutModel=null;this.initialLayoutError=null;this.secondaryResponses=null;this.bootstrapState=1;this._onSuccess=null;this._onError=null;this.$9=false;this.authoringGutter=null;if(!tsConfig.isPublic&&!tsConfig.toolbarvis){tsConfig.blogURI='';tsConfig.downloadURI=''}this.toolbarDisplayed=tsConfig.toolbarContainerVis;this.ts=(new Date).getTime();this.rid=0;this.location=window.location;tsConfig.showLytebox=ss.referenceEquals(window.self,window.top)&&!ss.isNullOrEmptyString(tsConfig.primaryContentUrl)&&!tsConfig.is_authoring;this.apiResponder=e||A.$0();this.setupClearSessionOnBrowserUnload();this.$9=false;this.authoringLeftAreaWidth=((tsConfig.is_authoring&&!tsConfig.is_mobile)?200:0);if(z.get_isEmbeddedInsideAnotherPage()){z.attachOneTimeMessageHandler(ss.mkdel(this,function(x){var C=f.parse(x.data.toString());if(C.get_name()==='tableau.enableVisibleRectCommunication'){this.isVisibleRectCommunicationEnabled=true;return true}return false}));z.sendCommandWithContext('tableau.listening')}this.authoringGutter={top:0,left:6,bottom:6,right:15};if(tsConfig.allow_commenting&&z.get_urlLocationSearchParams()[':showComments']==='true'&&tsConfig.commentingEnabled){this.set_rightAreaDrawerWidth(320)}};A.__typeName='tabBootstrap.ViewerBootstrap';A.get_instance=function(){return A._instance=A._instance||new A(A.$0())};A.get_canvasPixelLimit=function(){var e=25000000;if(ss.isValue(tsConfig.is_mobile)&&tsConfig.is_mobile){e=3000000}return e};A.resetInstance=function(){A._instance=null};A.makeOneTimeListener=function(e){var x=false;return function(C){if(x){return}x=true;e(C)}};A.makeOneTimeHandler=function(e){var x=false;return function(){if(x){return}x=true;e(null)}};A.$0=function(){if(tsConfig.is_mobile_app){return new o(null)}else{return new n}};global.tabBootstrap.ViewerBootstrap=A;var B=function(){};B.__typeName='tabBootstrap.VizLayoutConstants';B.get_vizToolbarHeight=function(){return(tsConfig.is_mobile_app?60:27)};B.get_displayToolbarHeight=function(){return(A.get_instance().toolbarDisplayed?B.get_vizToolbarHeight():0)};B.get_shouldShowTabs=function(){return tsConfig.showTabs};B.get_tabsHeight=function(){if(tsConfig.is_authoring){return 0}return(B.get_shouldShowTabs()?23:0)};B.get_authoringToolbarHeight=function(){if(!tsConfig.is_authoring){return 0}return(tsConfig.is_mobile?44:40)};B.get_authoringMenuBarHeight=function(){if(!tsConfig.is_authoring){return 0}else{return(tsConfig.is_mobile_app?44:60)}};B.get_authoringTabsHeight=function(){var e=(tsConfig.features['WebAddStatusBar']?48:30);return(tsConfig.is_authoring?e:0)};B.get_authoringVizBorderWidth=function(){return((tsConfig.is_authoring&&tsConfig.current_sheet_type!=='worksheet')?1:0)};B.get_authoringShelfWidth=function(){return(tsConfig.is_authoring?(tsConfig.is_mobile?50:190):0)};B.get_authoringShelfHeight=function(){if(tsConfig.is_metrics_authoring){return 0}return(tsConfig.is_authoring?(tsConfig.is_mobile?0:68):0)};B.get_authoringVizMargin=function(){return(tsConfig.is_authoring?6:0)};global.tabBootstrap.VizLayoutConstants=B;ss.initClass(b,a,{get_name:function(){return this.$1$1},set_name:function(e){this.$1$1=e},get_hostId:function(){return this.$1$2},set_hostId:function(e){this.$1$2=e},get_commandId:function(){return this.$1$3},set_commandId:function(e){this.$1$3=e},get_parameters:function(){return this.$1$4},set_parameters:function(e){this.$1$4=e},get_isApiCommandName:function(){return this.get_rawName().indexOf('api.',0)===0},get_rawName:function(){return this.get_name().toString()},serialize:function(){var e=[];e.push(this.get_name());e.push(this.get_commandId());e.push(this.get_hostId());if(ss.isValue(this.get_parameters())){e.push(this.get_parameters())}var x=e.join(',');return x}});ss.initClass(c,a,{get_workbookName:function(){return this.$1},get_worksheetName:function(){return this.$2},get_data:function(){return this.$0},serialize:function(){var e={};e['api.workbookName']=this.$1;e['api.worksheetName']=this.$2;e['api.commandData']=this.$0;return JSON.stringify(e)}});ss.initClass(d,a,{get_result:function(){return this.$1},get_data:function(){return this.$0}});ss.initClass(f,a,{get_name:function(){return this.$1$1},set_name:function(e){this.$1$1=e},get_parameters:function(){return this.$0},serialize:function(){var e=[];e.push(this.get_name().toString());e=e.concat.apply(e,this.$0);return e.join(',')}});ss.initClass(g,a,{logEvent:function(e){var x=g.$0(e.parameters.d,e.parameters.ei);var C;if(e.metricSuite===2&&ss.isValue(e.parameters.e)){C='AppStartEpochMarker'}else{C=g.$4(x)}g.$3(x,C)}});ss.initClass(s,a,{$0:function(){return this.end},dispose:function(){this.close()},close:function(){if(this.open){this.end=t.getTiming();t.$1(this);this.open=false;if(ss.isValue(this.$5)){this.$5.close()}}},elapsedMS:function(){if(!this.open){return this.end-this.start}return t.getTiming()-this.start}},null,[ss.IDisposable]);s.$ctor1.prototype=s.prototype;ss.initClass(h,a,{close:function(){if(this.open){this.open=false;g.$3(this.$6,null)}}},s,[ss.IDisposable]);ss.initClass(i,a,{close:function(){}},s,[ss.IDisposable]);ss.initClass(j,a,{});ss.initClass(k,a,{});ss.initEnum(l,a,{$4:1,$3:2,$2:3,$1:4,$0:5});ss.initClass(m,a,{sendResponse:null,sendEventNotification:function(e,x,C){var D=m.$0(tsConfig.workbookName,ss.coalesce(x,''),ss.coalesce(C,''));var E=new b(e,'xdomainSourceId',tsConfig.apiID,D);this.sendResponse(E,D)}});ss.initClass(n,a,{$0:function(){return!ss.referenceEquals(window.window,window.parent)},sendResponse:function(e,x){if(!('postMessage'in window)||!this.$0()){return}var C=e.get_name();var D=new b(C,e.get_commandId(),e.get_hostId(),x);var E=D.serialize();window.parent.postMessage(E,'*')}},m);ss.initClass(o,a,{get_responseAction:function(){return this.$2$1},set_responseAction:function(e){this.$2$1=e},sendResponse:function(e,x){if(!ss.staticEquals(this.get_responseAction(),null)){this.get_responseAction()(e,x)}}},m);ss.initClass(p,a,{});ss.initEnum(q,a,{notEmbedded:'notEmbedded',sameDomainEmbedded:'sameDomainEmbedded',crossDomainEmbedded:'crossDomainEmbedded'},true);ss.initClass(r,a,{},Object);ss.initClass(t,a,{$0:function(){var e=this.$8;++this.$8;return e},$2:function(){var e={id:this.$9,sid:this.$6,wb:this.$b,s:this.$a,m:tsConfig.is_mobile};t.logEventInternalUse(new u('init',2,e))},$1:function(e){var x=t.$0(e);x.t=e.$0();x.e=e.elapsedMS();t.logEventInternalUse(new u('wp',e.$4,x))}});ss.initClass(u,a,{});ss.initEnum(v,a,{none:0,navigation:1,bootstrap:2,commands:4,rendering:16,debug:32,toolbar:64,fonts:128,hitTest:256,min:3,core:15,all:65535});ss.initClass(w,a,{$0:function(e){switch(e){case 0:{return'Nav'}case 1:{return'Reload'}case 2:{return'BackFwd'}case 255:{return'Reserved'}default:{return null}}}});ss.initClass(y,a,{});ss.initClass(z,a,{});ss.initClass(A,a,{get_hasBootstrapCompleted:function(){return this.bootstrapState===4||this.bootstrapState===5},get_hasBootstrapSucceeded:function(){return this.bootstrapState===4},get_hasBootstrapFailed:function(){return this.bootstrapState===5},get_authoringLeftAreaWidth:function(){return this.authoringLeftAreaWidth},set_authoringLeftAreaWidth:function(e){this.authoringLeftAreaWidth=e},get_rightAreaDrawerWidth:function(){return this.rightAreaDrawerWidth},set_rightAreaDrawerWidth:function(e){this.rightAreaDrawerWidth=e},get_sessionBeingCleared:function(){return this.$9},get_clientDimension:function(){if(ss.isValue(this.$5)){return this.$5}var e=z.get_urlLocationSearchParams()[':size'];var x=(ss.isValue(e)?e.split(String.fromCharCode(44)).map(function(C){return parseInt(C)}):null);this.$5=((ss.isNullOrUndefined(x)||isNaN(x[0])||isNaN(x[1]))?{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight}:{w:x[0],h:x[1]});return this.$5},get_deviceType:function(){return this.$8},get_detectedDeviceType:function(){return this.$7},get_compositeSize:function(){if(ss.isValue(this.$6)){return this.$6}this.$6=this.getCompositeSizeForDeviceType(this.get_deviceType());return this.$6},getCompositeSizeForDeviceType:function(e){var x=JSON.parse(tsConfig.composite_sizes);return x[A.$2[e]]},setupClearSessionOnBrowserUnload:function(){this.clearSessionOnUnload=tsConfig.clear_session_on_unload&&!tsConfig.is_mobile_app;if(!this.clearSessionOnUnload){return}if(ss.isValue(window.self['addEventListener'])){window.addEventListener('beforeunload',ss.mkdel(this,function(){this.$9=true;this.clearSession()}),false)}else if(ss.isValue(window.self['attachEvent'])){window.attachEvent('onbeforeunload',ss.mkdel(this,function(){this.$9=true;this.clearSession()}))}},disableClearSessionOnBrowserUnload:function(){this.clearSessionOnUnload=false},waitOnInitialLayoutModel:function(e,x,C){if(this.get_hasBootstrapCompleted()){x(null);return}if(this.bootstrapState!==3){this._onSuccess=e;this._onError=x;this['_onSecondary']=C}else{this._onError=x;this['_onSecondary']=C;var D=this.initialLayoutModel;var E=this.initialLayoutError;if(ss.isValue(E)||ss.isNullOrUndefined(D)){this.bootstrapState=5;x(E)}else{e(D);this.bootstrapState=4;if(ss.isValue(C)&&ss.isValue(this.secondaryResponses)){for(var F=0;F<this.secondaryResponses.length;F++){C(this.secondaryResponses[F])}}}}},$4:function(){var e=null;e=ss.mkdel(this,function(x){var C=x;var D=f.parse(C.data.toString());if(D.get_name()==='tableau.bootstrap'){var E=this.$0();this.$3(E);if(ss.isValue(window.self.removeEventListener)){window.removeEventListener('message',e,false)}else{window.self.detachEvent('onmessage',e)}}});if(ss.isValue(window.self.addEventListener)){window.addEventListener('message',e,false)}else{window.self.attachEvent('onmessage',e)}},bootstrapRecoverSession:function(e,x){this.$1();var C=this.$0();C.push(':recover_old_session_id='+encodeURIComponent(e));var D=encodeURIComponent(ss.arrayFromEnumerable(x).join(','));C.push(':recover_session_state_tickets='+D);this.$3(C)},bootstrap:function(){this.$1();if(tsConfig.bootstrapWhenNotified&&z.get_isEmbeddedInsideAnotherPage()){this.$4()}else{var e=ss.mkdel(this,function(){var x=this.$0();this.$3(x)});if(window.innerHeight===0||window.innerWidth===0){window.requestAnimationFrame(function(x){e()})}else{e()}}this.$2()},$1:function(){var e=Math.min(this.get_clientDimension().w,this.get_clientDimension().h);this.$7=((e<=tsConfig.dsd_phone_max_size)?'phone':((e<=tsConfig.dsd_tablet_max_size)?'tablet':'desktop'));var x=(tsConfig.features['SelectDeviceLayoutOnWeb']?tsConfig.deviceTypeOverride:z.get_urlLocationSearchParams()[':device']);if(!ss.isNullOrEmptyString(x)){var C=ss.getEnumerator(Object.keys(A.$2));try{while(C.moveNext()){var D=C.current();if(ss.referenceEquals(A.$2[D],x)&&D!=='default'){this.$8=D;return}}}finally{C.dispose()}}this.$8=this.$7},$0:function(){var e=[];var x=this.getWebClientPortSize('worksheet');e.push('worksheetPortSize='+encodeURIComponent(JSON.stringify(x)));x=this.getWebClientPortSize('dashboard');e.push('dashboardPortSize='+encodeURIComponent(JSON.stringify(x)));if(!tsConfig.is_authoring){e.push('clientDimension='+encodeURIComponent(JSON.stringify(this.get_clientDimension())))}var C=mapboxgl.supported();e.push('renderMapsClientSide='+C.toString());e.push('isBrowserRendering='+tsConfig.is_browser_rendering_requested);e.push('browserRenderingThreshold='+tsConfig.browser_rendering_threshold);e.push('formatDataValueLocally='+tsConfig.formatDataValueLocally);e.push('clientNum='+encodeURIComponent(z.get_hashClientNumber()));var D=new w;e.push('navType='+encodeURIComponent(D.navType));e.push('navSrc='+encodeURIComponent(D.navSrc));var E=z.$1();e.push('devicePixelRatio='+encodeURIComponent(E.toString()));if(ss.isValue(tsConfig.is_mobile)&&tsConfig.is_mobile){e.push('imageSizeLimit='+encodeURIComponent((5242880).toString()));e.push('transparentLineMarkLimit='+1200)}e.push('clientRenderPixelLimit='+encodeURIComponent(A.get_canvasPixelLimit().toString()));if(!ss.isNullOrEmptyString(tsConfig.deviceTypeOverride)){e.push(':device='+tsConfig.deviceTypeOverride)}if(ss.isValue(tsConfig.sheetId)){e.push('sheet_id='+encodeURIComponent(tsConfig.sheetId.toString()))}if(ss.isValue(tsConfig.showParams)){e.push('showParams='+encodeURIComponent(tsConfig.showParams.toString()))}if(ss.isValue(tsConfig.stickySessionKey)){e.push('stickySessionKey='+encodeURIComponent(tsConfig.stickySessionKey))}if(ss.isValue(tsConfig.filterTileSize)){e.push('filterTileSize='+encodeURIComponent(tsConfig.filterTileSize.toString()))}if(ss.isValue(tsConfig.workbookLocale)){e.push('workbookLocale='+encodeURIComponent(tsConfig.workbookLocale))}if(ss.isValue(tsConfig.locale)){e.push('locale='+encodeURIComponent(tsConfig.locale.toString()))}if(ss.isValue(tsConfig.language)){e.push('language='+encodeURIComponent(tsConfig.language.toString()))}if(ss.isValue(tsConfig.syncSession)&&tsConfig.syncSession.length!==0&&typeof(tsConfig.syncSession)==='string'){e.push('sync_session_state='+encodeURIComponent(this.getSyncSessionState(tsConfig.syncSession)))}if(ss.isValue(tsConfig.debugMode)){e.push('verboseMode='+tsConfig.debugMode)}if(ss.isValue(tsConfig.features_json)){e.push(':session_feature_flags='+encodeURIComponent(tsConfig.features_json.toString()))}if(ss.isValue(tsConfig.keychain_version)){e.push('keychain_version='+tsConfig.keychain_version)}return e},$3:function(e){this.rid++;var x=document.getElementById('staticImage');if(tsConfig.bootstrapOnMouseover){this.scaleImageToFit(x)}var C=e.join('&');var D=p.formatBootstrapSessionMethod('bootstrapSession',tsConfig.sessionid,null);var E=this.rid;var F=t.createContext('BTSTRP'.toString(),2,null);var G=this;var H=ss.mkdel(this,function(N){F.dispose();N.rid=E;if(ss.isValue(this._onSuccess)){this._onSuccess(N);this.bootstrapState=4}else{this.bootstrapState=3}this.markInitialLayoutModelAsFinished(N,null)});var I=function(N){if('_onSecondary'in G){G['_onSecondary'](N)}else{G.appendSecondaryResponse(N)}};var J=ss.mkdel(this,function(N){if(ss.isValue(this._onError)){this.bootstrapState=5;this._onError(N)}else{this.bootstrapState=3}this.markInitialLayoutModelAsFinished(null,N);F.dispose()});var K=ss.mkdel(this,function(){this.bootstrapState=2;if(ss.isNullOrUndefined(tsConfig.offlineBootstrapResponse)){z.xhrPostJsonChunked(D,C,H,I,J,true)}else{if(tsConfig.offlineBootstrapResponse.length===0){throw new ss.Exception('Offline bootstrap response is empty')}H(JSON.parse(tsConfig.offlineBootstrapResponse[0]));for(var N=1;N<tsConfig.offlineBootstrapResponse.length;N++){I(JSON.parse(tsConfig.offlineBootstrapResponse[N]))}}});if(!tsConfig.bootstrapOnMouseover){K();return}var L=document.getElementById('initializing_thin_client');this.hideLoadIndicators(L,x);var M=ss.mkdel(this,function(){this.showLoadIndicators(L,x);K()});if(ss.isValue(x)){if(ss.isValue(x.addEventListener)){x.addEventListener('mouseover',A.makeOneTimeListener(M),false)}else if(ss.isValue(x.attachEvent)){x.attachEvent('onmouseover',A.makeOneTimeHandler(M))}}},showLyteboxIfNeeded:function(){if(tsConfig.showLytebox){document.getElementById('primaryContent').style.display='block';document.getElementById('primaryContentLink').style.display='';document.getElementById('centeringContainer').className='lyteboxed';document.getElementById('lyteboxClose').style.display='block';document.body.className+=' lyteboxed'}},getViewport:function(){if(tsConfig.is_mobile_device&&!tsConfig.embedded){return z.$3()}return((tsConfig.features['IframeSizedToWindow']&&!tsConfig.is_mobile)?z.$6():z.$5())},$2:function(){var e=new Object;e.maxHeight=this.get_compositeSize().maxHeight;e.maxWidth=this.get_compositeSize().maxWidth;e.minHeight=this.get_compositeSize().minHeight;e.minWidth=this.get_compositeSize().minWidth;var x=e;var C=new Object;C.sizeConstraints=x;C.chromeHeight=this.chromeMetricsForViewingOnly().h;var D=C;this.apiResponder.sendEventNotification('api.FirstVizSizeKnownEvent',null,JSON.stringify(D))},getSyncSessionState:function(e){var x=e.split(String.fromCharCode(47));var C=p.formatBootstrapSessionMethod('get_global_filters',x[1],'/'+x[0]);return z.xhrGetXmlSynchronous(C,null)},getWebClientDashboardContainerSize:function(e){var x=this.getViewport();var C=this.chromeMetrics(e);x.h-=C.h;x.w-=C.w;return this.adjustForMinMaxDashboardSizes(x)},getVizClientContainerSize:function(e){var x=this.getWebClientDashboardContainerSize(e);x.h+=B.get_tabsHeight()+B.get_displayToolbarHeight();return x},getWebClientPortSize:function(e){var x=this.getWebClientDashboardContainerSize(e);if(e==='dashboard'&&ss.isValue(tsConfig.features)&&tsConfig.is_authoring){x.h-=this.authoringGutter.top+this.authoringGutter.bottom;x.w-=this.authoringGutter.left+this.authoringGutter.right}return this.adjustForMinMaxDashboardSizes(x)},adjustForMinMaxDashboardSizes:function(e){var x=this.get_compositeSize().minWidth;var C=this.get_compositeSize().maxWidth;if(x!==0&&e.w<x){e.w=x}else if(C!==0&&e.w>C){e.w=C}else if(tsConfig.showLytebox){e.w=tsConfig.lyteboxedVizWidth}var D=this.get_compositeSize().minHeight;if(D!==0&&e.h<D){e.h=D}else{var E=this.get_compositeSize().maxHeight;if(E!==0&&e.h>E){e.h=E}}return e},chromeMetrics:function(e){var x=0;var C=0;if(this.toolbarDisplayed){x+=B.get_vizToolbarHeight()}x+=B.get_authoringToolbarHeight();x+=B.get_authoringMenuBarHeight();x+=B.get_authoringTabsHeight();x+=B.get_tabsHeight();if(!tsConfig.is_mobile){x+=2*B.get_authoringVizBorderWidth();C+=2*B.get_authoringVizBorderWidth()}if(e==='worksheet'){x+=B.get_authoringShelfHeight();C+=B.get_authoringShelfWidth();C+=this.get_authoringLeftAreaWidth();if(!tsConfig.is_mobile){x+=B.get_authoringVizMargin();C+=B.get_authoringVizMargin()}}else if(e==='dashboard'||e==='story'){C+=this.get_authoringLeftAreaWidth()}C+=this.get_rightAreaDrawerWidth();return{w:C,h:x}},getWebClientContentSizeForViewingOnly:function(){var e=this.getViewport();var x=this.chromeMetricsForViewingOnly();e.h-=x.h;e.w-=x.w;return this.adjustForMinMaxDashboardSizes(e)},chromeMetricsForViewingOnly:function(){var e=0;if(this.toolbarDisplayed){e+=B.get_vizToolbarHeight()}e+=B.get_tabsHeight();return{w:0,h:e}},showLoadIndicators:function(e,x){if(ss.isValue(e)){e.style.display='block'}if(ss.isValue(x)){x.style.cursor='wait'}},hideLoadIndicators:function(e,x){if(!ss.isNullOrUndefined(e)){e.style.display='none'}if(!ss.isNullOrUndefined(x)){x.style.cursor='default'}},clearSession:function(){if(!this.clearSessionOnUnload){return}var e=p.formatBootstrapSessionMethod('clear',tsConfig.sessionid,null);var x=function(){};z.xhrPostJson(e,null,x,x,false)},markInitialLayoutModelAsFinished:function(e,x){this.initialLayoutError=x;this.initialLayoutModel=e;delete this['_onSuccess']},appendSecondaryResponse:function(e){if(ss.isValue(this.secondaryResponses)){this.secondaryResponses.push(e)}else{this.secondaryResponses=[e]}},scaleImageToFit:function(e){var x=e.style.backgroundImage.replace(new RegExp('"','g'),'').replace(new RegExp('url\\((.*)\\)','gi'),'$1');var C=document.createElement('img');var D=ss.mkdel(this,function(){var F=this.getWebClientContentSizeForViewingOnly();var G=this.chromeMetricsForViewingOnly();var H={w:F.w+G.w-parseInt(e.style.left,10),h:F.h+G.h-parseInt(e.style.top,10)};if(ss.Int32.div(H.h,C.height)<ss.Int32.div(H.w,C.width)){var I=Math.round(H.h*C.width/C.height);e.style.backgroundSize=I+'px '+H.h+'px'}else{var J=Math.round(H.w*C.height/C.width);e.style.backgroundSize=H.w+'px '+J+'px'}});if(ss.isValue(C.addEventListener)){C.addEventListener('load',D,false)}else if(ss.isValue(C.attachEvent)){C.attachEvent('onload',function(){D(null)})}else{C.onload=D}var E=function(){tsConfig.bootstrapOnMouseover=false;if(ss.isNullOrUndefined(e)){return}if(ss.isValue(e.dispatchEvent)){var F=document.createEvent('MouseEvents');F.initMouseEvent('mouseover',true,true,window.self,null,0,0,0,0,false,false,false,false,null,null);e.dispatchEvent(F)}else if(ss.isValue(e['fireEvent'])){e['fireEvent']('onmouseover')}};if(ss.isValue(C['addEventListener'])){C.addEventListener('error',E,false)}else if(ss.isValue(C['attachEvent'])){C.attachEvent('onerror',function(){E(null)})}else{C['onerror']=E}C.src=x}});ss.initClass(B,a,{});ss.setMetadata(v,{enumFlags:true});(function(){b.crossDomainEventNotificationId='xdomainSourceId';b.$0=0})();(function(){y.supportsPerfApi=false;var e=window.window;y.supportsPerfApi=ss.isValue(e['performance'])&&ss.isValue(e['performance']['mark'])})();(function(){i.$1=null})();(function(){h.$0=0})();(function(){g.$6='AppStartEpochMarker'})();(function(){t.$5=ss.mkdict(['BTSTRP','Bootstrap Request','PROPRI','Process Primary Payload','PROSEC','Process Secondary Payload','MDLINI','Initialize Models','MDLEVT','Handle Model Events','EXELOC','Execute Local Command','EXEREM','Execute Remote Command','PROLOC','Process Local Command Response','PROREM','Process Remote Command Response','RNDRPT','Render Panetable','RNDRRG','Render Region','RTCONV','Runtime model presmodel conversion','CLNTLD','Client Loaded','APPSTR','Application Startup','APPINT','Application Interactive','ALLZNS','All Zones Loaded','TBRLAY','Toolbar Layout','TBRHNT','Toolbar HandleNewToolbar','TBRADD','Toolbar AddToolbar','TBRHRE','Toolbar HandleResize','MDLOAD','Load js async','EMLOAD','Emscripten load','RTLOAD','Runtime load','RTLPRC','Runtime command local processing']);t.getTiming=null;t.recordingStart=0;t.$7=false;t.$8=null;t.$4=0;t.$9=null;t.$6=new g;t.$7=y.supportsPerfApi;t.recordingStart=(new Date).getTime();if(ss.isValue(window)&&ss.isValue(window.self.performance)&&ss.isValue(window.self.performance['now'])){var e;if(ss.isValue(window.self.performance.timing)){e=window.self.performance.timing.responseStart-window.self.performance.timing.navigationStart}else{e=0}t.getTiming=function(){return window.self.performance.now()-e}}else{var x=(new Date).getTime();t.getTiming=function(){return(new Date).getTime()-x}}t.$4=t.getTiming();if(t.$7){g.$5()}t.$8={};t.$8['none']=0;t.$8['navigation']=1;t.$8['bootstrap']=2;t.$8['rendering']=16;t.$8['commands']=4;t.$8['toolbar']=64;t.$8['hittest']=256;t.$8['debug']=32;t.$8['fonts']=128;t.$8['min']=3;t.$8['core']=15;t.$8['all']=65535})();(function(){j.$1='en-us'})();(function(){window.onerror=ss.delegateCombine(window.onerror,function(e,x,C,D,E){return k.$0(e)});k.$2();j.$0()})();(function(){z.$e='navType';z.$d='navSrc';z.CLIENTNO='cn';z.$c=null;z.$c=z.$0()})();(function(){A.ipadImageSizeLimit=5242880;A.$1=1200;A.$2=ss.mkdict(['phone','phone','tablet','tablet','desktop','desktop','default','default']);A._instance=null})();(function(){B.toolbarHeight=27;B.largeToolbarHeight=60;B.tabsHeightPx=23;B.rightAreaDrawerWidth=320;B.$0=60;B.$1=44})()})();'use strict';if(typeof module!=='undefined'&&module.exports){module.exports=isSupported}else if(window){window.mapboxgl=window.mapboxgl||{};window.mapboxgl.supported=isSupported}function isSupported(options){return!!(isBrowser()&&isArraySupported()&&isFunctionSupported()&&isObjectSupported()&&isJSONSupported()&&isWorkerSupported()&&isUint8ClampedArraySupported()&&isArrayBufferSupported()&&isWebGLSupportedCached(options&&options.failIfMajorPerformanceCaveat))}function isBrowser(){return typeof window!=='undefined'&&typeof document!=='undefined'}function isArraySupported(){return(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)}function isFunctionSupported(){return Function.prototype&&Function.prototype.bind}function isObjectSupported(){return(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)}function isJSONSupported(){return'JSON'in window&&'parse'in JSON&&'stringify'in JSON}function isWorkerSupported(){if(!('Worker'in window&&'Blob'in window&&'URL'in window)){return false}var blob=new Blob([''],{type:'text/javascript'});var workerURL=URL.createObjectURL(blob);var supported;var worker;try{worker=new Worker(workerURL);supported=true}catch(e){supported=false}if(worker){worker.terminate()}URL.revokeObjectURL(workerURL);return supported}function isUint8ClampedArraySupported(){return'Uint8ClampedArray'in window}function isArrayBufferSupported(){return ArrayBuffer.isView}var isWebGLSupportedCache={};function isWebGLSupportedCached(failIfMajorPerformanceCaveat){if(isWebGLSupportedCache[failIfMajorPerformanceCaveat]===undefined){isWebGLSupportedCache[failIfMajorPerformanceCaveat]=isWebGLSupported(failIfMajorPerformanceCaveat)}return isWebGLSupportedCache[failIfMajorPerformanceCaveat]}isSupported.webGLContextAttributes={antialias:false,alpha:true,stencil:true,depth:true};function isWebGLSupported(failIfMajorPerformanceCaveat){var canvas=document.createElement('canvas');var attributes=Object.create(isSupported.webGLContextAttributes);attributes.failIfMajorPerformanceCaveat=failIfMajorPerformanceCaveat;if(canvas.probablySupportsContext){return(canvas.probablySupportsContext('webgl',attributes)||canvas.probablySupportsContext('experimental-webgl',attributes))}else if(canvas.supportsContext){return(canvas.supportsContext('webgl',attributes)||canvas.supportsContext('experimental-webgl',attributes))}else{return(canvas.getContext('webgl',attributes)||canvas.getContext('experimental-webgl',attributes))}}var viewerBootstrap=tabBootstrap.ViewerBootstrap.get_instance();viewerBootstrap.bootstrap();viewerBootstrap.showLyteboxIfNeeded()})();